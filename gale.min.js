!function(){function e(e){return this.identifier=e||"data-translateid",this.previousLanguage=null,this.currentLanguage=null,this.translationSourceLoaded=!1,this.translationRawSource=null,this.translationSource=null,this.inverseTranslationSource=null,this.translationMeta=null,this.availableLanguages=null,this.caching=!0,this.elementCache=[],this.translateFromCache=!0,this.debug=!0,this.deepDebug=!1,this}e.prototype.loadSourceFromJSON=function(e,t){var n=this;n._processSource(e,t)},e.prototype.loadSourceFromObject=function(e,t){var n=this;n._processSource(e,t)},e.prototype.translateApp=function(e,t){var n=this,a=!1;if("undefined"==typeof t)var t=!0;if(!n.translationSourceLoaded)throw new Error("Could not translate, translation source is not loaded!");if(-1===Object.keys(n.translationSource).indexOf(e))throw new Error("Could not translate, supplied language not found in source");if(t&&n.elementCache.length>0){n.debug&&console.log("Translating cached elements (translateFromCache = "+t+"; elementCacheLength = "+n.elementCache.length+")"),n.debug&&console.time("Cached element translate time");for(var o in n.elementCache){var r=n.elementCache[o],i=r.getAttribute(n.identifier);if("undefined"==typeof i||!i)return void(n.deepDebug&&console.log("Skipped "+r.tagName));n._translateElement(r,e),n.deepDebug&&console.log(i)}n.debug&&console.timeEnd("Cached element translate time"),a=!0}else{n.debug&&console.log("Translating and caching noncached elements (caching = "+n.caching+")"),n.debug&&console.time("Noncached element translate time");var l=document.getElementsByTagName("*");for(var o in l){var r=l[o];if(1===r.nodeType){var i=r.getAttribute(n.identifier);"undefined"!=typeof i&&i?(n.caching&&(n._inElementCache(r)||n.elementCache.push(r)),n._translateElement(r,e),n.deepDebug&&console.log(i)):n.deepDebug&&console.log("Skipped "+r.tagName)}}n.debug&&console.timeEnd("Noncached element translate time"),a=!0}a&&(n.previousLanguage&&(n.previousLanguage=n.currentLanguage),n.currentLanguage=e,n.previousLanguage||(n.previousLanguage=n.currentLanguage))},e.prototype.getTranslationsById=function(e){var t=this,n={};if(!t.translationSourceLoaded)throw new Error("Could not get translation by id, translation source not loaded");for(var a in t.translationSource){var o=t.translationSource[a];for(var r in o){var i=o[r];r===e&&(n[a]=i)}}return n},e.prototype.reverseTranslationLookup=function(e){var t=this,n={},a=!1,o=null;if(!t.translationSourceLoaded)throw new Error("Could not perform reverse translation lookup, translation source not loaded");for(var r in t.translationSource){var i=t.translationSource[r];for(var l in i){var s=i[l];if(s===e){o=l,a=!0;break}}if(a)break}if(a){for(var r in t.translationSource){var i=t.translationSource[r];for(var l in i){var s=i[l];l===o&&(n[r]=s)}}return n}return{}},e.prototype._processSource=function(e,t){var n=this;if(n.translationSourceLoaded=!1,null!==e)if("object"==typeof e)n._processSourceCallback(e,t);else{if("string"!=typeof e)throw new Error("Could not determine translation source type");n._getJSON(e).then(function(e){n._processSourceCallback(e,t)},function(e){throw n.translationSourceLoaded=!1,new Error("Failed to load translation source from JSON: "+e)})}},e.prototype._processSourceCallback=function(e,t){var n=this;if(!(e&&e.meta&&e.translations))throw n.translationSourceLoaded=!1,new Error("Translation source cannot be null and / or it must include meta and data objects");if(n.translationRawSource=e,n.translationMeta=e.meta,!e.meta.availableLanguages)throw new Error("Meta 'availableLanguages' not found in translation source!");n.debug&&console.log("Meta 'availableLanguages' found for translation source"),n.availableLanguages=e.meta.availableLanguages,n.translationMeta.availableLanguagesCount=Object.keys(e.meta.availableLanguages).length,n.translationSource=e.translations,n.inverseTranslationSource=n._invertSource(),n.translationSourceLoaded=!0,t.call(n)},e.prototype._translateElement=function(e,t){var n=this,a=n.translationSource[t],o=e.getAttribute(n.identifier);"undefined"!=typeof a[o]&&a[o]||console.log("'"+t+"' Translation not found for id '"+o+"'"),"INPUT"===e.nodeName?"button"==e.type||"submit"==e.type?(n.deepDebug&&console.log("Translated element = BUTTON INPUT"),e.setAttribute("value",a[o])):"text"==e.type||"password"==e.type||"textarea"==e.type||"textbox"==e.type?(n.deepDebug&&console.log("Translated element = TEXT INPUT"),e.setAttribute("placeholder",a[o])):(n.deepDebug&&console.log("Translated element = NORMAL"),e.innerHTML=a[o]):(n.deepDebug&&console.log("Translated element = NORMAL"),e.innerHTML=a[o])},e.prototype._inElementCache=function(e){var t=this;for(var n in t.elementCache)if(t.elementCache[n]==e)return!0;return!1},e.prototype._invertSource=function(){var e=this,t={};for(var n in e.translationSource){var a=e.translationSource[n];t[n]={};var o=t[n];for(var r in a)o[a[r]]=r}return t},e.prototype._getJSON=function(e){return new Promise(function(t,n){var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="json",a.overrideMimeType("application/json"),a.onload=function(){var e=a.status;e>=200&&400>e?t(a.response):(console.log(a),n(e))},a.send()})},"undefined"!=typeof module&&module.exports?module.exports=e:"function"==typeof define&&define.amd?define(function(){return e}):window.Gale=e}();